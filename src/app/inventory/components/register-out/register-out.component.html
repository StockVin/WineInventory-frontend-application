<div class="register-out-container">
    <div class="header">
        <h2 class="title">Registrar Salida</h2>
    </div>

    <form [formGroup]="registerOutForm" (ngSubmit)="onSubmit()">

        <mat-form-field appearance="outline" class="form-field">
            <mat-label>Producto a retirar</mat-label>
            <mat-select formControlName="productId" placeholder="Selecciona un producto">
                <mat-option *ngFor="let product of products" [value]="product.id">
                    {{ product.name }} (Stock: {{ product.currentStock }})
                </mat-option>
            </mat-select>
            <mat-error *ngIf="registerOutForm.get('productId')?.hasError('required')">
                El producto es requerido.
            </mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline" class="form-field">
            <mat-label>Tipo de salida</mat-label>
            <mat-select formControlName="outputType" placeholder="Selecciona el tipo de movimiento">
                <mat-option *ngFor="let type of outputTypes" [value]="type">
                    {{ type }}
                </mat-option>
            </mat-select>
            <mat-error *ngIf="registerOutForm.get('outputType')?.hasError('required')">
                El tipo de salida es requerido.
            </mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline" class="form-field">
            <mat-label>Cantidad</mat-label>
            <input matInput type="number" formControlName="quantity" placeholder="Ingrese la cantidad a retirar">

            <mat-hint *ngIf="registerOutForm.get('productId')?.value">
                Stock actual: **{{ maxQuantity }}** unidades.
            </mat-hint>

            <mat-error *ngIf="registerOutForm.get('quantity')?.hasError('required')">
                La cantidad es requerida.
            </mat-error>
            <mat-error *ngIf="registerOutForm.get('quantity')?.hasError('min')">
                La cantidad mínima es 1.
            </mat-error>
            <mat-error *ngIf="registerOutForm.get('quantity')?.hasError('max')">
                ⚠️ Solo quedan {{ maxQuantity }} unidades en stock.
            </mat-error>
        </mat-form-field>

        <div class="actions">
            <button mat-flat-button type="button" class="cancel-btn" (click)="onCancel()">
                Cancelar
            </button>

            <button mat-flat-button type="submit" class="register-btn" [disabled]="registerOutForm.invalid">
                Registrar
            </button>
        </div>

    </form>
</div>